<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Read Float from File</title>
  </head>
  <body>
    <input type="file" id="fileInput" />
    <script>
      document.getElementById('fileInput').addEventListener('change', function (event) {
        const file = event.target.files[0];
        if (!file) {
          return;
        }

        const reader = new FileReader();

        reader.onload = function (e) {
          const arrayBuffer = e.target.result;
          // 创建 DataView 用于读取 ArrayBuffer
          let dataView = new DataView(arrayBuffer);

          // 计算 float 数组的长度
          let floatArrayLength = arrayBuffer.byteLength / 4;

          // 创建一个数组存储 float 数据
          let floatArray = new Float32Array(floatArrayLength);

          // 将每4个字节转换为一个 float
          for (let i = 0; i < floatArrayLength; i++) {
            const value = dataView.getFloat32(i * 4, true); // true 表示小端字节序
            floatArray[i] = value < 0.1 ? 0 : parseInt(value * 10);
          }
          console.log(floatArray);
          return floatArray;
        };

        reader.readAsArrayBuffer(file);
      });
    </script>
  </body>
</html>
